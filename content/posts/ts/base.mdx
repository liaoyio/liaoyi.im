---
title: TypeScript
description: ä¸€äº› TypeScript æŠ€å·§å¤‡å¿˜å½•ğŸ“ã€‚
date: 2025-05-16
tags: ['TypeScripts', 'Tips']
author: liaoyi
series: TypeScript
seriesPart: 1
---

## å¯é€‰ç±»å‹ä¸ä¸€å®šç¬¦åˆé¢„æœŸ

```ts twoslash
const doThing = (ctx?: { traceId?: string }) => {}

const doAnotherThing = (ctx: { traceId: string | undefined }) => {}

const mainFunction = (ctx: { traceId?: string }) => {
  doThing()
  // å¿…é¡»ä¼ å…¥ traceId
  doAnotherThing({ traceId: ctx.traceId })
}
```


## æ¨¡æ¿å­—ç¬¦ä¸²ç±»å‹

```ts twoslash

type SupportedLangs = "en" | "pt"
type FooterIds = "header" | "footer"

type AllLocaleIDs = `${SupportedLangs}_${FooterIds}`
```
- [ç©è½¬ TS æ¨¡æ¿å­—ç¬¦ä¸²ç±»å‹](https://juejin.cn/post/7129864202604249096)

## ä½¿ç”¨ Pick å’Œ Omit

```ts twoslash
interface Album {
  id: string
  title: string
  artist: string
  releaseYear?: number
  genre?: { parentGenre?: string, subGenre?: string }
}

// Pick æŒ‘é€‰
type AlbumData1 = Pick< Album, 'title' | 'artist' >

// Omit çœç•¥
type AlbumData2 = Omit< Album, 'id' | 'releaseYear' | 'genre' >

// extract æå–
// âŒ ä¸èµ·ä½œç”¨
type AlbumData3 = Extract< Album, 'id' | 'artist' >

// exclude æ’é™¤
// å…¨é‡è¿”å›
type AlbumData4 = Exclude< Album, 'id' | 'artist' >

// âš ï¸ï¼š æå–å’Œæ’é™¤åªå¯¹è”åˆç±»å‹èµ·ä½œç”¨

```

## ä½¿ç”¨ Extract æå–ç±»å‹

```ts twoslash
type Example = 'a' | 'b' | 1 | 2 | 8 | 'as'

// extract æå–
type Numbers = Extract<Example, number>

type Strings = Extract<Example, string>

// Exclude æ’é™¤
type Numbers2 = Exclude<Example, string>

type Strings2 = Exclude<Example, number>

```



## ä½¿ç”¨ Exclude æ’é™¤ç±»å‹

```ts twoslash
// exclude æ’é™¤

type AlbumState =
  | {
    type: 'released'
    releaseDate: string
  }
  | {
    type: 'recording'
    studio: string
  }
  | {
    type: 'mixing'
    engineer: string
  }

// exclude æ’é™¤
type NotReleased = Exclude< AlbumState, { type: 'released' } >

```

- æ›´å¤šå†…ç½®ç±»å‹è¯·å‚è€ƒï¼š[TypeScript å·¥å…·ç±»å‹](https://bosens-china.github.io/Typescript-manual/download/zh/reference/utility-types.html#%E7%9B%AE%E5%BD%95)



## æ›´å‹å¥½çš„æ˜¾ç¤ºç±»å‹

```ts twoslash
type ComplexType = {
  a: string
  b: number
} & {
  c: boolean
} & {
  d: string []
}

type ComplexType2 = {
  a: string
  b: number
} & Omit<{ c: boolean } & { d: Record<'d', string[]> }, 'c'>
& { e: 'en_US' | 'zh_CN' }

type ShowMe = ComplexType
type ShowMe2 = ComplexType2

export type Prettify<T> = {
  [K in keyof T]: T[K]
} & {} // æ·»åŠ  & {} é¿å…ç±»å‹ä¿æŒä¸ºå¼•ç”¨å½¢å¼

type ShowMe3 = Prettify<ComplexType2>

type WithFormProps = { isForm: true, onSubmit: () => void }
type WithoutFormProps = { isForm?: false, onSubmit?: never }

type DialogProps = { open: boolean, onClose: () => void } & (WithFormProps | WithoutFormProps)

type DialogProps_ = Prettify<DialogProps>

```


## åœ¨å­—é¢é‡è”åˆç±»å‹ä½¿ç”¨é­”æ³• ğŸ§™â€â™€ï¸


```ts twoslash
type ModelNames =
  | 'gtp-4o'
  | 'o3-mini'
  | 'claude-sonnet-3.7'
  | 'gemini-1.5-flash'
  | (string & {})

const GTP: ModelNames = 'gtp-4o'
const model: ModelNames = 'qianwen'

// å¹³æ›¿æ–¹æ¡ˆ
type LooseAutocomplete<T extends string> = T | Omit<string, T>
type Color = LooseAutocomplete<'red' | 'green' | 'blue'>

// âœ… é¢„è®¾å€¼
const a: Color = 'red'

// âœ… è‡ªå®šä¹‰å­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚æœåŠ¡ç«¯é…ç½®è¿”å›çš„æ–°å€¼ï¼‰
const b: Color = 'purple'

// âŒ é”™è¯¯ç¤ºä¾‹ï¼šnumber ä¸ç¬¦åˆ string ç±»å‹
// const c: Color = 123
```


## æ˜ å°„ç±»å‹

```ts twoslash
type User = {
  id: string
  name: string
  age: number
}

type UserTransfromed = {
  // [K in keyof User]: K
  // ========= â¬‡ï¸ =========
  // [K in keyof User]: [K]
  // ========= â¬‡ï¸ =========
  [K in keyof User]: User[K]
}

type UserTransfromed_2 = {
  readonly [K in keyof User]?: User[K]
}

type UserTransfromed_3 = {
  [K in keyof User as Capitalize<K>]: User[K]
}

type UserTransfromed_4 = {
  [K in keyof User as `get${Capitalize<K>}`]: User[K]
}

type UserTransfromed_5 = {
  [K in keyof User as `get${Capitalize<K>}`]: () => User[K]
}

type Setters<T extends object> = {
  [K in Extract<keyof T, string> as `set${Capitalize<K>}`]?: (value: T[K]) => T[K]
}
```


```ts twoslash
// ** ğŸ”„ æ˜ å°„ç±»å‹ ** -> åŠ¨æ€è½¬æ¢å¯¹è±¡ç±»å‹
type Artist = { name: string; bio: string }

type SubscriberType<T> = {
  [Property in keyof T]: (value: T[Property]) => void
}

type ArtistSubscriber = SubscriberType<Artist>
```

- [Capitalize](https://www.typescriptlang.org/docs/handbook/2/template-literal-types.html#capitalizestringtype): è½¬æ¢å­—ç¬¦ä¸²ç±»å‹ç¬¬ä¸€ä¸ªå­—æ¯ä¸ºå¤§å†™ã€‚


## ç´¢å¼•æ˜ å°„ç±»å‹ (IIMT)

```ts  twoslash
type Prettify<T> = { [K in keyof T]: T[K] } & {} // æ·»åŠ  & {} é¿å…ç±»å‹ä¿æŒä¸ºå¼•ç”¨å½¢å¼

type Actions = {
  login: { userName: string, password: string }
  logout: { reason: string }
  update: { id: string, data: unknown }
}

type ActionAsDiscoUnion = {
  // [K in keyof Actions]: { type: K } & Actions[K]
  // ========= â¬‡ï¸ =========
  [K in keyof Actions]: Prettify<{ type: K } & Actions[K]>
}

// ğŸŒ° ç´¢å¼•æ˜ å°„ç±»å‹çš„åŸºæœ¬ä½¿ç”¨ ï¼ˆğŸ“ ä»ç°æœ‰å€¼æ¨å¯¼ç±»å‹ï¼‰
type Values_ = Actions['login']

// type Values_2 = Actions['login' | 'logout' | 'update']
// ========= â¬‡ï¸ =========
type Values = Actions[keyof Actions]

type ActionAsDiscoUnion_ = ActionAsDiscoUnion[keyof Actions]
```


## + - ä¿®é¥°ç¬¦

`+` `-` ä¿®é¥°ç¬¦å¯ä»¥æ·»åŠ æˆ–å»æ‰ `readonly` å’Œ `?`ï¼Œå¦‚ï¼š

```ts  twoslash
type LockedAccount = { readonly id?: string, readonly name?: string }

// å»é™¤æ‰€æœ‰å±æ€§ä¸Šçš„ readonly å’Œå¯é€‰ä¿®é¥°ç¬¦
type CreateMutable<T> = {
  -readonly [K in keyof T]-?: T[K]
}

type UnlockedAccount = CreateMutable<LockedAccount>

// ç»™æ‰€æœ‰å±æ€§æ·»åŠ  readonly å’Œå¯é€‰ä¿®é¥°ç¬¦
type CreateMutableAndReadonly<T> = {
  +readonly [K in keyof T]+?: T[K]
}

type FullyMutable = CreateMutableAndReadonly<UnlockedAccount>
```


## é€šè¿‡ as é‡æ–°ï¼ˆå¼ºåˆ¶ï¼‰æ˜ å°„ç±»å‹

åœ¨TypeScript 4.1åŠæ›´é«˜ç‰ˆæœ¬ä¸­ï¼Œå¯ä»¥åœ¨æ˜ å°„ç±»å‹ä¸­ä½¿ç”¨aså­å¥é‡æ–°æ˜ å°„æ˜ å°„ç±»å‹ä¸­çš„é”®ï¼Œå½¢å¼å¦‚ä¸‹ï¼š

```ts  twoslash

type NewKeyType = KeyType
// ---cut---
type MappedTypeWithNewProperties<Type> = {
    [Properties in keyof Type as NewKeyType]: Type[Properties]
}
```

ğŸŒ° ç¤ºä¾‹ä¸€ï¼Œæ ¹æ®å·²çŸ¥ç±»å‹çš„é”®æ˜ å°„å‡ºæ–°ç±»å‹é”®ï¼š


```ts  twoslash
type Getters<Type> = {
    [Property in keyof Type as `get${Capitalize<string & Property>}`]: () => Type[Property]
}

interface Person {
    name: string
    age: number
    location: string
}

type LazyPerson = Getters<Person>
```

ğŸŒ° ç¤ºä¾‹äºŒï¼šæ˜ å°„ä»»æ„è”åˆç±»å‹ï¼š

```ts  twoslash
type EventConfig<Events extends { kind: string }> = {
    [E in Events as E["kind"]]: (event: E) => void
}

type SquareEvent = { kind: "square", x: number, y: number }
type CircleEvent = { kind: "circle", radius: number }

type Config = EventConfig<SquareEvent | CircleEvent>

// ä½¿ç”¨ç¤ºä¾‹
const _config: Config = {
  square: ({ kind, x, y }) => {},
  circle: ({ kind, radius }) => {}
}
```